<!DOCTYPE html>
<html>
<head>
	<title>Bright News</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="icon" href="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/apple/237/white-sun-with-small-cloud_1f324.png">
	<link rel="stylesheet" type="text/css" href="css/grid12.css">
	<link rel="stylesheet" type="text/css" href="css/normalize.css">
	<link rel="stylesheet" type="text/css" href="css/styles.css">

</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-md-8 col-md-offset-2">
				<div class="intro">
					<img src="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/apple/237/white-sun-with-small-cloud_1f324.png" class="intro-logo">
					<h1 class="intro-header">The Bright News</h1>
					<h4 class="intro-sub-header">A curated list of good things happening around the world that we can appreciate. Also, your daily dose of morning wellness.</h4>
					<a class="btn btn-primary">Suggest news</a>
				</div>
				<div id="app">
					<div class="news-grid">
						<a v-for="item in news_items" class="grid-item card" v-bind:style="{ backgroundColor: item.color}" v-bind:href="item.url" target="_blank">
							<p class="date">{{item.date}}</p>
							<h3 class="title">{{item.title}}</h3>
							<span class="btn">Read more</span>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="https://code.jquery.com/jquery-3.5.0.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<script type="text/javascript" src="js/list.min.js"></script>
  	<script type="text/javascript" src="js/airtable.browser.js"></script>
	<script type="text/javascript" src="js/masonry.pkgd.min.js"></script>
	<script type="text/javascript">


		var AIRTABLE_API_KEY = "keyaY233WFzFahQdD";
		var AIRTABLE_APP_ID = "appM8lsxA6x7LaALC";

		var Airtable = require('airtable');

		var base = new Airtable({apiKey: 'keyaY233WFzFahQdD'}).base('appM8lsxA6x7LaALC');


		var app = new Vue({
		  el: '#app',
		  mounted: function(){
		  	this.loadItems();
		  },
		  data: {
		  	colors: ['#87CEEB', '#FF7F50', '#66CDAA', '#FF8C00', '#AFEEEE', '#FFA07A', '#D8BFD8', '#FFD700', '#FFA07A', '#DDA0DD', '#BC8F8F', '#FFE4B5', '#F28D8C', '#FFC800', '#74EADE'],
		    news_items: [],
		  },
		  methods: {
		  	loadItems: function(){

				var self = this	
		  		var app_id = AIRTABLE_APP_ID;
				var app_key = AIRTABLE_API_KEY;

				base('PublishedNews').select({
				    maxRecords: 100,
				    view: "Grid view"
				}).eachPage(function page(records, fetchNextPage) {
				    records.forEach((record)=>{
				    	console.log(record);
				    	var title = record.fields['Title'];
				    	var date = record.fields['Date'];
				    	var url = record.fields['URL'];
				    	var color = self.colors[Math.floor(Math.random() * self.colors.length)];
				    	var news = {
				    		'title': title,
				    		'date': date,
				    		'url': url,
				    		'color': color,
				    	}
				    	self.news_items.push(news);
				    });

				    console.log(self.news_items, 9090);

				    fetchNextPage();

				}, function done(err) {
				    if (err) { console.error(err); return; }
				    setTimeout(function(){
				  		$('.news-grid').masonry({
							itemSelector: '.grid-item',
							gutter: 30,
						});
				  	});
				});
		  	}
		  },
		});



	</script>
</body>
</html>